{
  "id": "f8fc93a7-3977-4cbc-84bd-8c8d025d6825",
  "jobName": "Ligação",
  "selectSql": "select distinct\r\n\tl.id,\r\n\t(case\r\n\t\twhen l.dtligacao ~ '^[0-9]{8}$'\r\n\t\tand TO_CHAR(TO_DATE(l.dtligacao, 'YYYYMMDD'), 'YYYYMMDD') = l.dtligacao then TO_DATE(l.dtligacao, 'YYYYMMDD')\r\n\t\telse null\r\n\tend)::text,\r\n\t(case\r\n\t\twhen l.datainstalacaoagua ~ '^[0-9]{8}$'\r\n\t\tand TO_CHAR(TO_DATE(l.datainstalacaoagua, 'YYYYMMDD'), 'YYYYMMDD') = l.datainstalacaoagua then TO_DATE(l.datainstalacaoagua, 'YYYYMMDD')\r\n\t\telse null\r\n\tend)::text,\r\n\t(case\r\n\t\twhen l.datainstalacaoesgoto ~ '^[0-9]{8}$'\r\n\t\tand TO_CHAR(TO_DATE(l.datainstalacaoesgoto, 'YYYYMMDD'), 'YYYYMMDD') = l.datainstalacaoesgoto then TO_DATE(l.datainstalacaoesgoto, 'YYYYMMDD')\r\n\t\telse null\r\n\tend)::text,\r\n\tleft(l.inscricao,255) inscricao,\r\n\tcase\r\n\t\twhen l.lote = '' then null\r\n\t\telse l.lote\r\n\tend::int,\r\n\tl.numeromoradores ,\r\n\tl.quadra,\r\n\tl.quadraent ,\r\n\tl.quadraleit ,\r\n\tl.seqent,\r\n\tl.seqleit,\r\n\tl.idbacia ,\r\n\tl.idsituacaocavalete ,\r\n\tl.idclienteinquilino id_cliente_inquilino,\r\n\tl.idcliente id_cliente_proprietario,\r\n\tl.idcobrancafase id_cobranca_fase,\r\n\tl.idtipocobranca id_cobranca_tipo,\r\n\tl.id id_endereco_imovel,\r\n\tl.idtipoentrega id_entrega_tipo,\r\n\tcase\r\n\t\twhen l.idtipofaturamento \u003e 3 then 1\r\n\t\telse l.idtipofaturamento\r\n\tend id_faturamento_tipo,\r\n\tl.idfonteabastecimento id_fonte_abastecimento,\r\n\tl.idgrupoent id_grupo_entrega,\r\n\tl.idgrupoleit id_grupo_medicao,\r\n\tl.idsituacaoimovel id_imovel_situacao,\r\n\tl.idsituacaoligacao id_ligacao_situacao,\r\n\tcase\r\n\t\twhen l.idtipoligacao \u003e 4 then 3\r\n\t\telse l.idtipoligacao\r\n\tend id_ligacao_tipo,\r\n\tl.idpadraoinstalacao id_local_padrao_instalacao,\r\n\tidmedidor id_medidor,\r\n\tidtipopavimento id_pavimento_tipo,\r\n\tl.idreservatorio id_reservatorio,\r\n\tl.idzonamacro id_zona_macro,\r\n\tl.idzonapressao id_zona_pressao,\r\n\tfalse cosolidada,\r\n\tl.iddistrito id_distrito,\r\n\tl.areaconstruida area_construida,\r\n\tl.areaverde area_verde,\r\n\tl.capacidadereservatorio capacidade_reservatorio,\r\n\tl.iddiametroramalagua diametro_ramal_agua,\r\n\tl.iddiametroramalesgoto diametro_ramal_esgoto,\r\n\tl.distanciaramalagua distancia_ramal_agua,\r\n\tl.distanciaramalesgoto distancia_ramal_esgoto,\r\n\tleft(l.observacaoligacao,255) observacao,\r\n\tfalse possui_piscina,\r\n\t0 volume_piscina,\r\n\tl.idtipocalcada id_calcada_tipo,\r\n\tl.id id_endereco_entrega,\r\n\t1 id_imovel_tipo,\r\n\t1 id_ocupacao_tipo,\r\n\tl.idtiporede id_rede_agua_tipo,\r\n\tl.idposicaorede id_rede_posicao_agua,\r\n\tl.idposicaoredeesgoto id_rede_posicao_esgoto,\r\n\t(l.idfontealternativa + 100) id_fonte_alternativa,\r\n\tl.subunidleit sub_unidade_entrega,\r\n\tl.subunidleit sub_unidade_leitura,\r\n\t0 area_coberta\r\nfrom ( select \r\n\t*, \r\n\tctid, \r\n\trow_number() over (partition by idmedidor order by id) as idm\r\n\tfrom ligacao ) l\r\nleft join cliente c on (c.id = l.idcliente)\r\nleft join cliente ci on (ci.id = l.idclienteinquilino)\r\nwhere l.idm = 1",
  "insertSql": "INSERT INTO ${SCHEMA}.ligacao_imovel (id, data_cadastro_ligacao, data_instalacao_agua, data_instalacao_esgoto, inscricao_imovel, numero_lote, numero_moradores, quadra, quadra_entrega, quadra_leitura,  sequencia_entrega, sequencia_leitura, id_bacia, id_cavalete_situacao, id_cliente_inquilino, id_cliente_proprietario, id_cobranca_fase, id_cobranca_tipo, id_endereco_imovel, id_entrega_tipo, id_faturamento_tipo, id_fonte_abastecimento, id_grupo_entrega, id_grupo_medicao, id_imovel_situacao, id_ligacao_situacao, id_ligacao_tipo, id_local_padrao_instalacao, id_medidor, id_pavimento_tipo, id_reservatorio, id_zona_macro, id_zona_pressao, consolidada, id_distrito, area_construida, area_verde, capacidade_reservatorio, diametro_ramal_agua, diametro_ramal_esgoto, distancia_ramal_agua, distancia_ramal_esgoto, observacao, possui_piscina, volume_piscina, id_calcada_tipo, id_endereco_entrega, id_imovel_tipo, id_ocupacao_tipo, id_rede_agua_tipo, id_rede_posicao_agua, id_rede_posicao_esgoto, id_fonte_alternativa, sub_unidade_entrega, sub_unidade_leitura, area_coberta)",
  "posInsertSql": "ON CONFLICT (id_medidor)\nDO UPDATE SET id_medidor = NULL",
  "posInsert": "ON CONFLICT (id_medidor)\nDO UPDATE SET id_medidor = NULL",
  "columns": [
    "id",
    "text",
    "text",
    "text",
    "inscricao",
    "lote",
    "numeromoradores",
    "quadra",
    "quadraent",
    "quadraleit",
    "seqent",
    "seqleit",
    "idbacia",
    "idsituacaocavalete",
    "id_cliente_inquilino",
    "id_cliente_proprietario",
    "id_cobranca_fase",
    "id_cobranca_tipo",
    "id_endereco_imovel",
    "id_entrega_tipo",
    "id_faturamento_tipo",
    "id_fonte_abastecimento",
    "id_grupo_entrega",
    "id_grupo_medicao",
    "id_imovel_situacao",
    "id_ligacao_situacao",
    "id_ligacao_tipo",
    "id_local_padrao_instalacao",
    "id_medidor",
    "id_pavimento_tipo",
    "id_reservatorio",
    "id_zona_macro",
    "id_zona_pressao",
    "cosolidada",
    "id_distrito",
    "area_construida",
    "area_verde",
    "capacidade_reservatorio",
    "diametro_ramal_agua",
    "diametro_ramal_esgoto",
    "distancia_ramal_agua",
    "distancia_ramal_esgoto",
    "observacao",
    "possui_piscina",
    "volume_piscina",
    "id_calcada_tipo",
    "id_endereco_entrega",
    "id_imovel_tipo",
    "id_ocupacao_tipo",
    "id_rede_agua_tipo",
    "id_rede_posicao_agua",
    "id_rede_posicao_esgoto",
    "id_fonte_alternativa",
    "sub_unidade_entrega",
    "sub_unidade_leitura",
    "area_coberta"
  ],
  "primaryKeys": null,
  "recordsPerPage": 1000,
  "type": "insert",
  "stopOnError": true,
  "left": 500,
  "top": 4440
}